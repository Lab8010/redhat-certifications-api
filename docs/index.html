
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Red Hat Certifications</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="bg-light">

  <div class="container py-4">
    <h1 class="mb-4 text-danger">Red Hat Certifications</h1>

    <div class="row g-3 mb-3">
      <div class="col-md-4">
        <label class="form-label">RHCA Path</label>
        <select id="pathFilter" class="form-select">
          <option value="none">All</option>
          <option value="rhce">Active RHCE Holder</option>
          <option value="developer">Active RHCEMD/RHCCD Holder</option>
        </select>
      </div>

      <div class="col-md-4">
        <label class="form-label">Difficulty Level</label>
        <select id="levelFilter" class="form-select">
          <option value="all">All</option>
          <option value="100">Level 100</option>
          <option value="200">Level 200</option>
          <option value="300">Level 300</option>
          <option value="400">Level 400</option>
        </select>
      </div>

      <div class="col-md-4">
        <label class="form-label">Sort By</label>
        <select id="sortSelect" class="form-select">
          <option value="examAsc">Exam Code (A-Z)</option>
          <option value="examDesc">Exam Code (Z-A)</option>
          <option value="productAsc">Product (A-Z)</option>
          <option value="productDesc">Product (Z-A)</option>
          <option value="levelAsc">Level (Low-High)</option>
          <option value="levelDesc">Level (High-Low)</option>
        </select>
      </div>
    </div>

    <div class="mb-4">
      <button id="filterBtn" class="btn btn-primary">Apply Filters</button>
    </div>

    <div id="certList" class="row g-3">Loading certifications...</div>
  </div>

  <script>
    const rhceList = ["EX188","EX229","EX240","EX248","EX260","EX267","EX280","EX288","EX316","EX328","EX342","EX358","EX362","EX374","EX403"];
    const devList = ["EX188","EX240","EX248","EX280","EX288","EX328","EX374","EX378","EX380","EX480","EX482"];

    let certifications = [];

    function getLevelFromExam(examCode) {
      const match = examCode.match(/^EX(\d{3})/);
      if (!match) return null;
      const level = parseInt(match[1], 10);
      return Math.floor(level / 100) * 100;
    }

    function getExamLinks(url) {
      if (!url) return { en: "#", ja: "#" };
      return {
        ja: url,
        en: url.replace("/ja/", "/en/")
      };
    }

    function loadCertifications() {
      fetch('./data/certifications.json')
        .then(r => r.json())
        .then(data => {
          certifications = data.map(cert => ({
            ...cert,
            levelNum: getLevelFromExam(cert.exam)
          }));
          renderList(certifications);
        })
        .catch(err => {
          document.getElementById('certList').innerText = "Failed to load: " + err;
        });
    }

    function renderList(list) {
      const cont = document.getElementById('certList');
      cont.innerHTML = "";
      if (list.length === 0) {
        cont.innerHTML = "<p>No certifications match the filter criteria.</p>";
        return;
      }

      list.forEach(cert => {
        const col = document.createElement('div');
        col.className = "col-md-6 col-lg-4";
        const links = getExamLinks(cert.exam_link || cert.url);
        col.innerHTML = `
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <h5 class="card-title">${cert.title}</h5>
              <p class="card-text"><strong>Exam:</strong> ${cert.exam} | <strong>Level:</strong> ${cert.level}</p>
              <p class="card-text"><strong>Product:</strong> ${cert.product}<br><strong>Difficulty:</strong> Level ${cert.levelNum || "?"}</p>
              <p class="card-text">${cert.description}</p>
              <p>
                <a href="${links.en}" target="_blank" class="btn btn-sm btn-outline-secondary me-2">Exam Page (en)</a>
                <a href="${links.ja}" target="_blank" class="btn btn-sm btn-outline-secondary">Exam Page (ja)</a>
              </p>
            </div>
          </div>
        `;
        cont.appendChild(col);
      });
    }

    function applyFiltersAndSort() {
      const path = document.getElementById('pathFilter').value;
      const level = document.getElementById('levelFilter').value;
      const sort = document.getElementById('sortSelect').value;

      let filtered = [...certifications];

      if (path === "rhce") {
        filtered = filtered.filter(cert => rhceList.includes(cert.exam));
      } else if (path === "developer") {
        filtered = filtered.filter(cert => devList.includes(cert.exam));
      }

      if (level !== "all") {
        const levelNum = parseInt(level, 10);
        filtered = filtered.filter(cert => cert.levelNum === levelNum);
      }

      filtered.sort((a, b) => {
        switch (sort) {
          case "examAsc": return a.exam.localeCompare(b.exam);
          case "examDesc": return b.exam.localeCompare(a.exam);
          case "productAsc": return a.product.localeCompare(b.product);
          case "productDesc": return b.product.localeCompare(a.product);
          case "levelAsc": return (a.levelNum || 0) - (b.levelNum || 0);
          case "levelDesc": return (b.levelNum || 0) - (a.levelNum || 0);
          default: return 0;
        }
      });

      renderList(filtered);
    }

    document.getElementById('filterBtn').addEventListener('click', applyFiltersAndSort);
    loadCertifications();
  </script>
</body>
</html>
